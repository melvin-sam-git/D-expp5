1) Create & open the project in VS Code

Open VS Code → View → Terminal.

In the terminal, run:

mkdir python-ci-docker-lab
cd python-ci-docker-lab
code .


This opens the folder in a new VS Code window.

2) Create the application files

In VS Code, create these files with the exact contents.

app.py
def add(a, b):
    return a + b

if __name__ == "__main__":
    print("Hello from Python CI Lab!")
    print("2 + 3 =", add(2, 3))

tests/test_app.py

Create a tests folder, then inside it test_app.py:

from app import add

def test_add():
    assert add(2, 3) == 5
    assert add(-1, 1) == 0

requirements.txt
pytest==8.3.2

Dockerfile
FROM python:3.11-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt
COPY . .
CMD ["python", "app.py"]

.gitignore
__pycache__/
.venv/
.pytest_cache/
.DS_Store
*.pyc

3) (Optional) Test locally in VS Code

In the VS Code terminal:

Run the app

python app.py


Run tests

python -m pip install --upgrade pip
pip install -r requirements.txt
pytest -q


Build & run Docker locally (needs Docker Desktop running)

docker build -t yourname/python-ci-lab:local .
docker run --rm yourname/python-ci-lab:local


You should see:

Hello from Python CI Lab!
2 + 3 = 5

4) Add the GitHub Actions workflow

Create the folder .github/workflows/ and then a file inside it named ci-dockerhub.yml.

.github/workflows/ci-dockerhub.yml

⚠️ YAML indentation matters. Paste exactly.

name: ci-dockerhub

on:
  push:
    branches: [ "main" ]
    tags: [ "*" ]
  pull_request:
    branches: [ "main" ]

jobs:
  build-test-push:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install deps
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: Run tests
        run: pytest -q

      - name: Docker meta
        id: meta
        uses: docker/metadata-action@v5
        with:
          images: ${{ secrets.DOCKERHUB_USERNAME }}/python-ci-lab
          tags: |
            type=raw,value=latest,enable={{is_default_branch}}
            type=sha,prefix=sha-,format=short
            type=ref,event=tag

      - name: Set up QEMU
        uses: docker/setup-qemu-action@v3

      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v3

      - name: Login to Docker Hub
        uses: docker/login-action@v3
        with:
          username: ${{ secrets.DOCKERHUB_USERNAME }}
          password: ${{ secrets.DOCKERHUB_TOKEN }}

      - name: Build and push
        uses: docker/build-push-action@v6
        with:
          context: .
          push: true
          tags: ${{ steps.meta.outputs.tags }}
          labels: ${{ steps.meta.outputs.labels }}
          platforms: linux/amd64

5) Initialize Git and push to GitHub (from VS Code)

Git init & first commit (in terminal):

git init
git add .
git commit -m "init lab"


Create a new GitHub repo named python-ci-docker-lab (on github.com).

Link remote & push main:

git branch -M main
git remote add origin https://github.com/<your-username>/python-ci-docker-lab.git
git push -u origin main


If prompted for login, complete the GitHub authentication.

6) Add GitHub Secrets (for Docker Hub push)

Go to your GitHub repo → Settings → Secrets and variables → Actions → New repository secret.

Add two secrets:

DOCKERHUB_USERNAME → your Docker Hub username (exactly)

DOCKERHUB_TOKEN → Docker Hub Access Token (create it at hub.docker.com → Account Settings → Security → New Access Token). Save the token once and paste it here.

7) Watch the CI run

Go to your repo → Actions tab → open the latest run.

It will: checkout → set up Python → install deps → run tests → login to Docker Hub → build & push.

If it’s successful, the job ends green and you’ll see the image pushed.

8) Verify image on Docker Hub

Open Docker Hub → your profile → Repositories.

You should see:
docker.io/<DOCKERHUB_USERNAME>/python-ci-lab
with tags like latest (on main) and sha-<shortsha>.

(Optional) Pull & run it locally:

docker pull <DOCKERHUB_USERNAME>/python-ci-lab:latest
docker run --rm <DOCKERHUB_USERNAME>/python-ci-lab:latest

9) (Optional) Create a release tag to publish a version

From VS Code terminal:

git tag v1.0.0
git push origin v1.0.0


This triggers the workflow again and pushes an image tagged v1.0.0.

Quick Checklist (you can tick mentally in VS Code)

 Files created: app.py, tests/test_app.py, requirements.txt, Dockerfile, .gitignore, .github/workflows/ci-dockerhub.yml

 Repo pushed with default branch main

 GitHub secrets set: DOCKERHUB_USERNAME, DOCKERHUB_TOKEN

 Actions run is green

 Image appears on Docker Hub

Troubleshooting (common VS Code/Windows gotchas)

Workflow fails at Docker login:
Secrets missing or token wrong. Recreate token in Docker Hub and update DOCKERHUB_TOKEN.

“No basic auth credentials” in build step:
The Login to Docker Hub step must run before Build and push, and secrets must be set.

Tests fail:
Run locally in the VS Code terminal to see errors:

pip install -r requirements.txt
pytest -q


YAML error (“mapping values are not allowed here”):
Indentation or tabs. Replace tabs with spaces (2 spaces per level). Re-paste the file exactly.

Local Docker build fails on Windows:
Make sure Docker Desktop is running. Try docker logout and docker login again if needed.

Wrong image name on Docker Hub:
The workflow uses ${{ secrets.DOCKERHUB_USERNAME }}/python-ci-lab. Ensure the secret value matches your Docker Hub username exactly (case-sensitiv
